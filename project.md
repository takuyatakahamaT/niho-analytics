# NIHO Analytics プロジェクト

## 概要

NIHOkamakura（鎌倉市内のシェアリビングスペース）の利用者チェックイン履歴を分析・可視化するWebアプリケーションです。CSV形式の生データから利用者統計を算出し、GitHub Pagesでホストされるインタラクティブなダッシュボードとして提供します。

## 目的

1. **利用者行動の理解**: 月別利用パターン、滞在時間、リピート率などの分析
2. **運営判断の支援**: データに基づいた施設運営の最適化
3. **リアルタイム監視**: 当月と前月の利用状況比較による運営状況の把握
4. **可視化による洞察**: グラフや統計による直感的なデータ理解

## システム構成

### アーキテクチャ
```
CSV生データ → Node.js処理 → JSON出力 → Webダッシュボード → GitHub Pages
```

### ディレクトリ構成
```
niho-analytics/
├── data-processor/          # データ処理層
│   ├── process-csv.js      # メイン処理スクリプト
│   ├── realtime-analysis.js # リアルタイム比較分析
│   ├── niho-use-08.csv     # 生データ（8月分含む）
│   └── package.json        # Node.js依存関係
├── docs/                   # フロントエンド（GitHub Pages）
│   ├── index.html          # メインダッシュボード
│   ├── user-data.json      # 処理済み統計データ
│   ├── realtime-analysis.json # リアルタイム比較データ
│   └── *.csv *.json        # 中間ファイル群
└── project.md              # 本ドキュメント
```

## 実装内容

### 1. データ処理エンジン (`data-processor/`)

#### A. メイン統計処理 (`process-csv.js`)
- **機能**: CSV生データから利用者統計を算出
- **処理期間**:
  - 直近6ヶ月間
  - 2025年7月単月
  - 2025年8月単月
- **算出指標**:
  - 月平均訪問回数
  - 月平均利用時間
  - 活動月数
  - 総訪問回数
  - 総利用時間
  - 初回チェックイン日

#### B. リアルタイム比較分析 (`realtime-analysis.js`)
- **機能**: 当月と前月の同期間比較
- **比較指標**:
  - 延べ利用人数（セッション数）
  - 総利用時間
  - ピーク在館者数
  - 平均在館者数
  - ユニークユーザー数
- **時間別分析**: 24時間の在館者数推移
- **出力ファイル**:
  - `realtime-analysis.json`: 比較統計
  - `daily-stats.json`: 日別統計
  - `*-hourly.csv`: 時間別データ
  - `time-slots-detail.json`: 詳細時間分析

### 2. Webダッシュボード (`docs/index.html`)

#### A. UI構成
- **タブ式インターフェース**: 4つの分析ビュー
  - 📊 直近6ヶ月
  - 📊 2025年7月  
  - 📊 2025年8月
  - ⚡ リアルタイム比較
- **レスポンシブデザイン**: モバイル対応

#### B. 可視化機能
- **散布図**: 月平均訪問回数 vs 月平均利用時間（SVG）
- **棒グラフ**: 時間別在館者数推移（Canvas）
- **統計テーブル**: 全利用者詳細一覧
- **比較統計**: 前月対比の増減表示

#### C. インタラクション
- **フィルタリング**: 期間別データ切り替え
- **ソート**: テーブル列での並び替え
- **ドロップダウン**: 時間別データの表示切り替え

### 3. デプロイメント
- **GitHub Pages**: 静的サイトホスティング
- **自動更新**: GitHubプッシュによる即座反映
- **URL**: `https://takuyatakahamaT.github.io/niho-analytics/`

## 技術仕様

### バックエンド（データ処理）
- **言語**: Node.js (JavaScript)
- **ライブラリ**: 
  - `csv-parser`: CSV解析
  - `fs.promises`: ファイル操作
- **実行方法**: `node process-csv.js`, `node realtime-analysis.js`

### フロントエンド
- **技術**: Pure HTML5/CSS3/JavaScript（フレームワークなし）
- **可視化**: 
  - SVG: 散布図
  - Canvas: 棒グラフ
- **スタイリング**: CSS Grid, Flexbox

### データフォーマット
- **入力**: CSV（チェックイン日時、滞在時間、ユーザーID等）
- **中間**: JSON（構造化統計データ）
- **出力**: HTML（インタラクティブダッシュボード）

## 主要機能とその効果

### 1. 期間別分析
- **6ヶ月トレンド**: 長期的な利用パターン把握
- **月別比較**: 季節性や運営変更の影響分析
- **個別月分析**: 特定期間の詳細調査

### 2. リアルタイム監視
- **当月進捗**: 現在の利用状況の把握
- **前月対比**: 増減トレンドの早期発見
- **時間別パターン**: ピーク時間帯の特定

### 3. 利用者分析
- **行動パターン**: 訪問頻度と滞在時間の関係
- **セグメンテーション**: ヘビーユーザーとライトユーザーの識別
- **継続性**: 長期利用者の特徴分析

## 運用上の利点

### 1. データドリブンな意思決定
- 客観的な数値に基づく運営改善
- 仮説検証のための定量的指標
- 投資判断のための根拠データ

### 2. リアルタイム性
- 月末を待たずに当月の状況把握
- 問題の早期発見と対応
- トレンド変化の即座検知

### 3. 運用効率性
- 自動化されたレポート生成
- ブラウザ上での簡単アクセス
- 手動集計作業の削減

## 今後の拡張可能性

### 1. 短期的改善（1-3ヶ月）

#### A. データ処理の最適化
- **月別JSONファイル**: 大量データ対応のためのファイル分割
- **増分処理**: 新データのみの処理による高速化
- **エラーハンドリング**: 不正データの自動検出・除外

#### B. UI/UX改善
- **高度なフィルタリング**: 日付範囲、曜日、時間帯での絞り込み
- **エクスポート機能**: CSV/PDF形式でのレポート出力
- **詳細ツールチップ**: グラフ要素のホバー情報

#### C. 新しい分析指標
- **曜日別分析**: 平日/週末の利用パターン比較
- **滞在時間分布**: 短時間/長時間利用者の傾向
- **新規/既存比率**: 顧客獲得・維持の分析

### 2. 中期的発展（3-6ヶ月）

#### A. 予測分析
- **利用者予測**: 機械学習による将来利用者数の予測
- **需要予測**: 時間帯別の混雑度予測
- **トレンド分析**: 季節性やイベント影響の定量化

#### B. 比較分析
- **他施設比較**: 業界標準との比較分析
- **期間比較**: 年同月比較、前年同期比較
- **コホート分析**: 利用開始時期別の行動追跡

#### C. アラート機能
- **閾値監視**: 利用者数やピーク時の自動通知
- **異常検知**: 通常パターンからの逸脱検出
- **レポート配信**: 定期的な自動レポートメール

### 3. 長期的ビジョン（6ヶ月以上）

#### A. バックエンドAPI化
```
CSV → Database → REST API → フロントエンド
```
- **リアルタイムデータベース**: PostgreSQL/MongoDB
- **REST API**: Express.js/FastAPI
- **認証**: ユーザー管理とアクセス制御

#### B. 高度な分析プラットフォーム
- **ダッシュボードビルダー**: カスタマイズ可能な分析画面
- **SQLクエリエディタ**: 自由な条件での分析
- **レポートテンプレート**: 定型レポートの自動生成

#### C. 統合システム化
- **Bubbleアプリ連携**: NIHOアプリとのリアルタイム同期
- **決済データ統合**: 利用料金と利用パターンの相関分析
- **外部API連携**: 天気・イベント・交通データとの統合分析

### 4. 技術的改善案

#### A. パフォーマンス最適化
- **データ仮想化**: 大量データの効率的表示
- **キャッシング**: 計算結果のメモリ保存
- **並列処理**: マルチスレッドでの高速化

#### B. セキュリティ強化
- **データ暗号化**: 個人情報の保護
- **アクセス制御**: ロールベースの権限管理
- **監査ログ**: データアクセス履歴の記録

#### C. 可用性向上
- **バックアップ**: 自動的なデータバックアップ
- **冗長化**: システム障害に対する耐性
- **モニタリング**: システム状態の24時間監視

## 運用ガイド

### データ更新手順
1. 新しいCSVファイルを `data-processor/` に配置
2. `node process-csv.js` を実行
3. `node realtime-analysis.js` を実行  
4. 生成されたJSONファイルを `docs/` にコピー
5. GitHubにプッシュして自動デプロイ

### トラブルシューティング
- **データ読み込みエラー**: CSV形式とヘッダー列の確認
- **グラフ表示不具合**: ブラウザキャッシュのクリア
- **統計値異常**: データ期間と除外条件の確認

### 最適化のポイント
- **データ品質**: 入力CSVの形式統一
- **処理速度**: 大量データ時の分割処理
- **表示速度**: 必要最小限のデータ転送

## まとめ

本プロジェクトは、NIHOkamakuraの運営データを活用した包括的な分析システムです。現在は基本的な統計分析とリアルタイム比較機能を提供していますが、将来的には予測分析や他システムとの統合により、より高度な運営支援ツールとして発展させることが可能です。

シンプルな技術スタックながら実用的な機能を提供しており、データドリブンな施設運営の基盤として活用できます。段階的な機能拡張により、長期的にはNIHOの事業成長を支える重要なデータ基盤となることが期待されます。
